<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ChatBot アプリケーション設計書</title>
    <style>
        :root {
            --primary-color: #007bff;
            --secondary-color: #6c757d;
            --success-color: #28a745;
            --warning-color: #ffc107;
            --danger-color: #dc3545;
            --dark-color: #343a40;
            --light-bg: #f8f9fa;
            --border-color: #dee2e6;
            --shadow: 0 0.125rem 0.25rem rgba(0, 0, 0, 0.075);
            --shadow-lg: 0 1rem 3rem rgba(0, 0, 0, 0.175);
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, "Helvetica Neue", Arial, sans-serif;
            line-height: 1.6;
            color: var(--dark-color);
            background-color: #fff;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
        }

        h1 {
            color: var(--primary-color);
            text-align: center;
            margin-bottom: 30px;
            font-size: 2.5rem;
            border-bottom: 3px solid var(--primary-color);
            padding-bottom: 15px;
        }

        h2 {
            color: var(--primary-color);
            margin: 30px 0 20px 0;
            font-size: 1.8rem;
            border-left: 4px solid var(--primary-color);
            padding-left: 15px;
        }

        h3 {
            color: var(--secondary-color);
            margin: 25px 0 15px 0;
            font-size: 1.4rem;
        }

        h4 {
            color: var(--dark-color);
            margin: 20px 0 10px 0;
            font-size: 1.2rem;
        }

        .document-header {
            background: linear-gradient(135deg, var(--primary-color), #0056b3);
            color: white;
            padding: 40px 0;
            text-align: center;
            margin-bottom: 40px;
            border-radius: 10px;
            box-shadow: var(--shadow-lg);
        }

        .document-header h1 {
            color: white;
            border: none;
            margin: 0;
            font-size: 3rem;
        }

        .document-meta {
            background: var(--light-bg);
            padding: 20px;
            border-radius: 8px;
            margin-bottom: 30px;
            border: 1px solid var(--border-color);
        }

        .toc {
            background: #fff;
            border: 1px solid var(--border-color);
            border-radius: 8px;
            padding: 20px;
            margin-bottom: 30px;
            box-shadow: var(--shadow);
        }

        .toc ul {
            list-style: none;
            padding-left: 0;
        }

        .toc li {
            margin: 8px 0;
        }

        .toc a {
            color: var(--primary-color);
            text-decoration: none;
            padding: 5px 10px;
            border-radius: 4px;
            transition: background-color 0.3s;
        }

        .toc a:hover {
            background-color: var(--light-bg);
        }

        .section {
            background: #fff;
            margin-bottom: 30px;
            padding: 30px;
            border-radius: 8px;
            box-shadow: var(--shadow);
            border-left: 4px solid var(--primary-color);
        }

        .feature-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 20px;
            margin: 20px 0;
        }

        .feature-card {
            background: var(--light-bg);
            padding: 20px;
            border-radius: 8px;
            border: 1px solid var(--border-color);
            transition: transform 0.3s, box-shadow 0.3s;
        }

        .feature-card:hover {
            transform: translateY(-2px);
            box-shadow: var(--shadow-lg);
        }

        .feature-card h4 {
            color: var(--primary-color);
            margin-bottom: 10px;
        }

        .architecture-diagram {
            text-align: center;
            margin: 30px 0;
            padding: 20px;
            background: var(--light-bg);
            border-radius: 8px;
            border: 1px solid var(--border-color);
        }

        .file-structure {
            background: #f8f9fa;
            border: 1px solid var(--border-color);
            border-radius: 8px;
            padding: 20px;
            font-family: 'Courier New', monospace;
            margin: 20px 0;
            overflow-x: auto;
        }

        .file-structure pre {
            margin: 0;
            line-height: 1.4;
        }

        .module-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(350px, 1fr));
            gap: 20px;
            margin: 20px 0;
        }

        .module-card {
            background: #fff;
            border: 1px solid var(--border-color);
            border-radius: 8px;
            padding: 20px;
            box-shadow: var(--shadow);
        }

        .module-card h4 {
            background: var(--primary-color);
            color: white;
            margin: -20px -20px 15px -20px;
            padding: 15px 20px;
            border-radius: 8px 8px 0 0;
        }

        .responsibilities {
            background: var(--light-bg);
            padding: 15px;
            border-radius: 6px;
            margin: 10px 0;
        }

        .responsibilities h5 {
            margin-bottom: 10px;
            color: var(--secondary-color);
        }

        .responsibilities ul {
            margin-left: 20px;
        }

        .tech-stack {
            display: flex;
            flex-wrap: wrap;
            gap: 10px;
            margin: 20px 0;
        }

        .tech-badge {
            background: var(--primary-color);
            color: white;
            padding: 8px 16px;
            border-radius: 20px;
            font-size: 0.9rem;
            font-weight: 500;
        }

        .api-info {
            background: linear-gradient(135deg, #e3f2fd, #bbdefb);
            border: 1px solid #2196f3;
            border-radius: 8px;
            padding: 20px;
            margin: 20px 0;
        }

        .security-highlight {
            background: linear-gradient(135deg, #fff3e0, #ffe0b2);
            border: 1px solid #ff9800;
            border-radius: 8px;
            padding: 20px;
            margin: 20px 0;
        }

        .performance-tip {
            background: linear-gradient(135deg, #e8f5e8, #c8e6c8);
            border: 1px solid #4caf50;
            border-radius: 8px;
            padding: 20px;
            margin: 20px 0;
        }

        .back-to-top {
            position: fixed;
            bottom: 30px;
            right: 30px;
            background: var(--primary-color);
            color: white;
            border: none;
            border-radius: 50%;
            width: 50px;
            height: 50px;
            cursor: pointer;
            box-shadow: var(--shadow-lg);
            transition: background-color 0.3s;
        }

        .back-to-top:hover {
            background: #0056b3;
        }

        @media (max-width: 768px) {
            .container {
                padding: 10px;
            }

            .document-header h1 {
                font-size: 2rem;
            }

            .feature-grid,
            .module-grid {
                grid-template-columns: 1fr;
            }
        }

        .flow-diagram {
            display: flex;
            flex-direction: column;
            align-items: center;
            margin: 30px 0;
            padding: 20px;
            background: var(--light-bg);
            border-radius: 8px;
            border: 1px solid var(--border-color);
        }

        .flow-step {
            background: white;
            border: 2px solid var(--primary-color);
            border-radius: 8px;
            padding: 15px 20px;
            margin: 10px 0;
            text-align: center;
            min-width: 200px;
            box-shadow: var(--shadow);
        }

        .flow-arrow {
            font-size: 1.5rem;
            color: var(--primary-color);
            margin: 5px 0;
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="document-header">
            <h1>ChatBot アプリケーション設計書</h1>
            <p style="font-size: 1.1rem; margin-top: 10px;">AI搭載Webベースチャットアプリケーション</p>
        </div>

        <div class="document-meta">
            <p><strong>作成日:</strong> 2025年3月29日</p>
            <p><strong>バージョン:</strong> 1.0</p>
            <p><strong>作成者:</strong> ChatBot開発チーム</p>
            <p><strong>HTML版作成日:</strong> 2025年6月14日</p>
        </div>

        <div class="toc">
            <h2>目次</h2>
            <ul>
                <li><a href="#overview">1. 概要</a></li>
                <li><a href="#architecture">2. システムアーキテクチャ</a></li>
                <li><a href="#file-structure">3. ファイル構造</a></li>
                <li><a href="#module-details">4. モジュール詳細</a></li>
                <li><a href="#features">5. 主な機能</a></li>
                <li><a href="#tech-stack">6. 技術スタック</a></li>
                <li><a href="#api-config">7. API設定</a></li>
                <li><a href="#security">8. セキュリティ考慮事項</a></li>
                <li><a href="#performance">9. パフォーマンス最適化</a></li>
                <li><a href="#usage">10. 使用方法</a></li>
            </ul>
        </div>

        <section id="overview" class="section">
            <h2>1. 概要</h2>
            <p>ChatBotはAI搭載のWebベースチャットアプリケーションです。OpenAIのAPIとAzure OpenAI APIを活用して、ユーザーに高度な対話体験を提供します。マークダウン形式のメッセージ表示、コードハイライト、ファイル添付機能などを備えた多機能アプリケーションです。</p>
            
            <div class="feature-grid">
                <div class="feature-card">
                    <h4>🤖 AI対話機能</h4>
                    <p>OpenAI及びAzure OpenAI APIを使用した高度なAI対話機能</p>
                </div>
                <div class="feature-card">
                    <h4>📝 マークダウン対応</h4>
                    <p>リッチテキスト表示とコードシンタックスハイライト</p>
                </div>
                <div class="feature-card">
                    <h4>📁 ファイル添付</h4>
                    <p>多様なファイル形式の添付とプレビュー機能</p>
                </div>
                <div class="feature-card">
                    <h4>⚡ コード実行</h4>
                    <p>JavaScript、Python、C++、HTMLのブラウザ内実行</p>
                </div>
                <div class="feature-card">
                    <h4>💾 履歴管理</h4>
                    <p>チャット履歴の保存、復元、分類機能</p>
                </div>
                <div class="feature-card">
                    <h4>📱 レスポンシブ</h4>
                    <p>デスクトップ・モバイル対応の適応型UI</p>
                </div>
            </div>
        </section>

        <section id="architecture" class="section">
            <h2>2. システムアーキテクチャ</h2>
            <p>ChatBotはクライアントサイドのみで動作するSPA（Single Page Application）として設計されています。すべてのデータ処理と状態管理はブラウザ内で行われ、外部との通信はOpenAI/Azure OpenAI APIのみです。</p>
              <div class="architecture-diagram">
                <h3>システム構成図</h3>
                <div style="width: 100%; max-width: 1200px; margin: 20px auto;">
                    <object data="system-architecture.svg" type="image/svg+xml" style="width: 100%; height: auto; border: 1px solid #dee2e6; border-radius: 8px;">
                        <img src="system-architecture.svg" alt="ChatBot システム構成図" style="width: 100%; height: auto;">
                    </object>
                </div>
                <p style="text-align: center; color: #6c757d; font-size: 0.9rem; margin-top: 10px;">
                    <em>ChatBotアプリケーションの全体的なシステム構成とデータフロー</em>
                </p>
            </div>            <div class="api-info">
                <h4>アーキテクチャの特徴</h4>
                <ul>
                    <li><strong>完全クライアントサイド:</strong> サーバーを必要とせず、ブラウザのみで動作</li>
                    <li><strong>セキュア通信:</strong> HTTPS経由でAPIと直接通信</li>
                    <li><strong>オフライン対応:</strong> ローカルストレージによるデータ永続化</li>
                    <li><strong>拡張性:</strong> モジュラー設計による機能追加の容易性</li>
                </ul>
            </div>

            <h3>簡易フロー図</h3>
            <div class="flow-diagram">
                <div class="flow-step">
                    <strong>クライアント ブラウザ</strong><br>
                    <small>HTML + CSS + JavaScript</small>
                </div>
                <div class="flow-arrow">↕</div>
                <div class="flow-step">
                    <strong>ローカルストレージ</strong><br>
                    <small>設定・履歴データ保存</small>
                </div>
                <div class="flow-arrow">↕</div>
                <div style="display: flex; gap: 20px;">
                    <div class="flow-step">
                        <strong>OpenAI API</strong><br>
                        <small>GPT-4o, GPT-4o-mini等</small>
                    </div>
                    <div class="flow-step">
                        <strong>Azure OpenAI API</strong><br>
                        <small>企業向けAPIサービス</small>
                    </div>
                </div>
            </div>
        </section>

        <section id="file-structure" class="section">
            <h2>3. ファイル構造</h2>
            <div class="file-structure">
                <pre>
ChatBot/
│
├── index.html               # メインのHTMLファイル
├── main.js                  # アプリケーションのエントリーポイント
├── design-document.html     # 本設計書（HTML版）
├── ChatBot_設計仕様書.md    # 設計仕様書（Markdown版）
├── README.md                # プロジェクト概要説明
├── StartChatBot.bat         # Windows用起動バッチファイル
│
├── css/                     # スタイルシート関連ファイル
│   ├── base/                # 基本スタイル
│   │   ├── base.css         # 基本スタイル定義
│   │   └── variables.css    # CSS変数定義
│   ├── components/          # コンポーネント別スタイル
│   │   ├── animations/      # アニメーション
│   │   ├── buttons/         # ボタン
│   │   ├── chat/            # チャットUI
│   │   ├── code/            # コード実行
│   │   ├── file-preview/    # ファイルプレビュー
│   │   ├── forms/           # フォーム
│   │   ├── modals/          # モーダル
│   │   ├── notifications/   # 通知
│   │   ├── prompt/          # プロンプト
│   │   └── settings/        # 設定メニュー
│   └── layouts/             # レイアウト
│       └── layout.css       # ページレイアウト
│
├── icon/                    # アプリケーションアイコン
│   └── ChatBot.png          # アプリケーションアイコン
│
└── js/                      # JavaScriptモジュール
    ├── components/          # UI・機能コンポーネント
    │   ├── chat/            # チャット関連コンポーネント
    │   ├── fileAttachment/  # ファイル添付関連
    │   └── sidebar/         # サイドバー関連
    │
    ├── core/                # コア機能モジュール
    │   ├── executors/       # コード実行機能
    │   └── userprompts/     # ユーザープロンプト管理
    │
    ├── lib/                 # サードパーティライブラリ
    │   └── JSCPP.es5.min.js # C++実行ライブラリ
    │
    ├── modals/              # モーダルダイアログ管理
    │   ├── apiSettings/     # API設定モーダル
    │   ├── promptManager/   # プロンプト管理モーダル
    │   ├── renameChat/      # チャット名変更モーダル
    │   └── systemPrompt/    # システムプロンプト設定モーダル
    │
    └── utils/               # ユーティリティモジュール
        ├── cryptoHelper.js  # 暗号化/復号化
        ├── fileConverter.js # ファイル変換
        ├── fileHandler.js   # ファイル処理
        ├── fileReader.js    # ファイル読込
        ├── fileValidator.js # ファイル検証
        ├── markdown.js      # マークダウン処理
        └── webContentExtractor.js # Web内容抽出
                </pre>
            </div>
        </section>

        <section id="module-details" class="section">
            <h2>4. モジュール詳細</h2>
            
            <h3>コアモジュール</h3>
            <div class="module-grid">
                <div class="module-card">
                    <h4>main.js</h4>
                    <div class="responsibilities">
                        <h5>主な責任:</h5>
                        <ul>
                            <li>アプリケーションの初期化処理</li>
                            <li>イベントリスナーのセットアップ</li>
                            <li>外部ライブラリの動的読み込み</li>
                            <li>会話の初期ロード</li>
                            <li>Prism.jsコンポーネント管理</li>
                        </ul>
                    </div>
                </div>

                <div class="module-card">
                    <h4>js/core/api.js (AIAPIクラス)</h4>
                    <div class="responsibilities">
                        <h5>主な責任:</h5>
                        <ul>
                            <li>OpenAI APIとの通信</li>
                            <li>Azure OpenAI APIとの通信</li>
                            <li>エラーハンドリング</li>
                            <li>リクエスト/レスポンスの整形</li>
                            <li>ストリーミングレスポンスの処理</li>
                            <li>添付ファイルの処理</li>
                        </ul>
                    </div>
                </div>

                <div class="module-card">
                    <h4>js/core/appState.js</h4>
                    <div class="responsibilities">
                        <h5>主な責任:</h5>
                        <ul>
                            <li>現在の会話状態管理</li>
                            <li>会話履歴の管理</li>
                            <li>API設定の管理</li>
                            <li>システムプロンプトの管理</li>
                            <li>添付ファイルの状態管理</li>
                        </ul>
                    </div>
                </div>

                <div class="module-card">
                    <h4>js/core/storage.js (Storageクラス)</h4>
                    <div class="responsibilities">
                        <h5>主な責任:</h5>
                        <ul>
                            <li>API設定の保存/読込</li>
                            <li>会話履歴の保存/読込</li>
                            <li>システムプロンプトの保存/読込</li>
                            <li>プロンプトテンプレートの管理</li>
                            <li>カテゴリ状態の保存/読込</li>
                            <li>添付ファイルの保存/読込</li>
                        </ul>
                    </div>
                </div>
            </div>

            <h3>コンポーネントモジュール</h3>
            <div class="module-grid">
                <div class="module-card">
                    <h4>js/components/chat/chatRenderer.js</h4>
                    <div class="responsibilities">
                        <h5>主な責任:</h5>
                        <ul>
                            <li>メッセージの表示</li>
                            <li>ストリーミングレスポンスの表示</li>
                            <li>マークダウンのレンダリング</li>
                            <li>コードのシンタックスハイライト</li>
                        </ul>
                    </div>
                </div>

                <div class="module-card">
                    <h4>js/components/fileAttachment/fileAttachment.js</h4>
                    <div class="responsibilities">
                        <h5>主な責任:</h5>
                        <ul>
                            <li>添付ファイルのクリア</li>
                            <li>API用添付ファイル変換</li>
                            <li>会話用添付ファイルの保存</li>
                            <li>保存済み添付ファイルの表示</li>
                        </ul>
                    </div>
                </div>

                <div class="module-card">
                    <h4>js/core/executors/codeExecutor.js</h4>
                    <div class="responsibilities">
                        <h5>主な責任:</h5>
                        <ul>
                            <li>コード実行の初期化</li>
                            <li>言語検出</li>
                            <li>言語別エグゼキュータの選択</li>
                            <li>実行結果の表示管理</li>
                        </ul>
                    </div>
                </div>

                <div class="module-card">
                    <h4>js/utils/cryptoHelper.js</h4>
                    <div class="responsibilities">
                        <h5>主な責任:</h5>
                        <ul>
                            <li>APIキーの暗号化</li>
                            <li>暗号化データの復号化</li>
                            <li>暗号化キーの生成</li>
                            <li>セキュアなデータ保存</li>
                        </ul>
                    </div>
                </div>
            </div>
        </section>

        <section id="features" class="section">
            <h2>5. 主な機能</h2>
            
            <div class="feature-grid">
                <div class="feature-card">
                    <h4>🤖 複数AIモデル対応</h4>
                    <ul>
                        <li>gpt-4o-mini（高速・効率的）</li>
                        <li>gpt-4o（高性能・汎用）</li>
                        <li>o1-mini（論理的思考）</li>
                        <li>o1（高度な推論）</li>
                    </ul>
                </div>

                <div class="feature-card">
                    <h4>📡 API対応</h4>
                    <ul>
                        <li>OpenAI API対応</li>
                        <li>Azure OpenAI API対応</li>
                        <li>ストリーミングレスポンス</li>
                        <li>エラーハンドリング</li>
                    </ul>
                </div>

                <div class="feature-card">
                    <h4>📝 テキスト処理</h4>
                    <ul>
                        <li>マークダウン対応</li>
                        <li>コードシンタックスハイライト</li>
                        <li>LaTeX数式表示</li>
                        <li>リッチテキスト表示</li>
                    </ul>
                </div>

                <div class="feature-card">
                    <h4>📁 ファイル機能</h4>
                    <ul>
                        <li>画像・テキスト・PDF添付</li>
                        <li>ファイルプレビュー</li>
                        <li>ドラッグ&ドロップ対応</li>
                        <li>ファイル形式検証</li>
                    </ul>
                </div>

                <div class="feature-card">
                    <h4>⚡ コード実行</h4>
                    <ul>
                        <li>JavaScript実行</li>
                        <li>Python実行（Pyodide）</li>
                        <li>C++実行（JSCPP）</li>
                        <li>HTML/CSS実行</li>
                    </ul>
                </div>

                <div class="feature-card">
                    <h4>💾 データ管理</h4>
                    <ul>
                        <li>チャット履歴保存</li>
                        <li>プロンプトテンプレート</li>
                        <li>システムプロンプト管理</li>
                        <li>設定データ暗号化</li>
                    </ul>
                </div>
            </div>
        </section>

        <section id="tech-stack" class="section">
            <h2>6. 技術スタック</h2>
            
            <h3>フロントエンド技術</h3>
            <div class="tech-stack">
                <span class="tech-badge">HTML5</span>
                <span class="tech-badge">CSS3</span>
                <span class="tech-badge">JavaScript ES6+</span>
                <span class="tech-badge">Responsive Design</span>
            </div>

            <h3>外部ライブラリ</h3>
            <div class="tech-stack">
                <span class="tech-badge">Marked.js</span>
                <span class="tech-badge">Prism.js</span>
                <span class="tech-badge">Font Awesome</span>
                <span class="tech-badge">JSCPP</span>
                <span class="tech-badge">Pyodide</span>
            </div>

            <h3>API・サービス</h3>
            <div class="tech-stack">
                <span class="tech-badge">OpenAI API</span>
                <span class="tech-badge">Azure OpenAI API</span>
                <span class="tech-badge">Local Storage</span>
                <span class="tech-badge">Web Crypto API</span>
            </div>
        </section>

        <section id="api-config" class="section">
            <h2>7. API設定</h2>
            
            <div class="api-info">
                <h3>OpenAI API設定</h3>
                <ol>
                    <li><a href="https://platform.openai.com/" target="_blank">OpenAIのウェブサイト</a>からアカウントを作成</li>
                    <li>APIキーを取得</li>
                    <li>アプリ起動時またはAPI設定から、OpenAIを選択してAPIキーを入力</li>
                </ol>

                <h4>対応モデル</h4>
                <ul>
                    <li><strong>gpt-4o-mini:</strong> 高速で効率的な軽量モデル</li>
                    <li><strong>gpt-4o:</strong> 高性能な汎用モデル</li>
                    <li><strong>o1-mini:</strong> 論理的思考に特化したモデル</li>
                    <li><strong>o1:</strong> 高度な推論能力を持つモデル</li>
                </ul>
            </div>

            <div class="api-info">
                <h3>Azure OpenAI API設定</h3>
                <ol>
                    <li>Azureポータルで<a href="https://azure.microsoft.com/ja-jp/services/cognitive-services/openai-service/" target="_blank">Azure OpenAI Service</a>のリソースを作成</li>
                    <li>APIキーとエンドポイントを取得</li>
                    <li>各モデルのデプロイメント名を確認</li>
                    <li>アプリ起動時またはAPI設定から、Azureを選択して必要情報を入力</li>
                </ol>
            </div>
        </section>

        <section id="security" class="section">
            <h2>8. セキュリティ考慮事項</h2>
            
            <div class="security-highlight">
                <h3>データ保護</h3>
                <ul>
                    <li><strong>APIキー暗号化:</strong> Web Crypto APIを使用したAPIキーの暗号化保存</li>
                    <li><strong>ローカルストレージ:</strong> すべてのデータはブラウザ内にのみ保存</li>
                    <li><strong>HTTPS通信:</strong> API通信は暗号化された接続のみ使用</li>
                    <li><strong>データ分離:</strong> ユーザーデータは他のサイトから隔離</li>
                </ul>

                <h3>プライバシー保護</h3>
                <ul>
                    <li><strong>サーバーレス:</strong> 中間サーバーを経由しないAPI直接通信</li>
                    <li><strong>データ保持:</strong> ローカルのみでデータ保持、外部送信なし</li>
                    <li><strong>アクセス制御:</strong> ブラウザの同一オリジンポリシーによる保護</li>
                </ul>
            </div>
        </section>

        <section id="performance" class="section">
            <h2>9. パフォーマンス最適化</h2>
            
            <div class="performance-tip">
                <h3>フロントエンド最適化</h3>
                <ul>
                    <li><strong>レイジーローディング:</strong> 外部ライブラリの必要時読み込み</li>
                    <li><strong>DOM最適化:</strong> 効率的なDOM操作とキャッシュ機能</li>
                    <li><strong>メモリ管理:</strong> 適切なイベントリスナー管理</li>
                    <li><strong>ストリーミング:</strong> リアルタイムレスポンス表示</li>
                </ul>

                <h3>UX最適化</h3>
                <ul>
                    <li><strong>レスポンシブデザイン:</strong> デバイス毎の最適化UI</li>
                    <li><strong>アニメーション:</strong> 滑らかなUI遷移</li>
                    <li><strong>エラーハンドリング:</strong> ユーザーフレンドリーなエラー表示</li>
                    <li><strong>アクセシビリティ:</strong> キーボード操作対応</li>
                </ul>
            </div>
        </section>

        <section id="usage" class="section">
            <h2>10. 使用方法</h2>
            
            <div class="flow-diagram">
                <div class="flow-step">
                    <strong>1. アプリケーション起動</strong><br>
                    <small>index.htmlをブラウザで開く</small>
                </div>
                <div class="flow-arrow">↓</div>
                <div class="flow-step">
                    <strong>2. API設定</strong><br>
                    <small>OpenAI/Azure APIキーを入力</small>
                </div>
                <div class="flow-arrow">↓</div>
                <div class="flow-step">
                    <strong>3. モデル選択</strong><br>
                    <small>使用するAIモデルを選択</small>
                </div>
                <div class="flow-arrow">↓</div>
                <div class="flow-step">
                    <strong>4. チャット開始</strong><br>
                    <small>メッセージ入力・ファイル添付</small>
                </div>
                <div class="flow-arrow">↓</div>
                <div class="flow-step">
                    <strong>5. AI応答受信</strong><br>
                    <small>ストリーミングレスポンス表示</small>
                </div>
            </div>

            <h3>高度な機能</h3>
            <div class="feature-grid">
                <div class="feature-card">
                    <h4>📝 システムプロンプト</h4>
                    <p>設定メニューからAIの応答スタイルや性格をカスタマイズ。テンプレートとして保存・再利用可能。</p>
                </div>
                <div class="feature-card">
                    <h4>⚡ コード実行</h4>
                    <p>AIが返信したコードブロックの「実行」ボタンから、JavaScript、Python、C++、HTMLを直接実行。</p>
                </div>
                <div class="feature-card">
                    <h4>📁 ファイル添付</h4>
                    <p>ドラッグ&ドロップまたはクリックで画像・テキスト・PDFファイルを添付してAIに分析依頼。</p>
                </div>
                <div class="feature-card">
                    <h4>💾 履歴管理</h4>
                    <p>チャット履歴の保存・復元・名前変更・削除。カテゴリ別整理も可能。</p>
                </div>
            </div>
        </section>

        <button class="back-to-top" onclick="window.scrollTo({top: 0, behavior: 'smooth'})" title="トップに戻る">
            ↑
        </button>
    </div>

    <script>
        // スクロール時のナビゲーション表示制御
        window.addEventListener('scroll', function() {
            const backToTop = document.querySelector('.back-to-top');
            if (window.pageYOffset > 300) {
                backToTop.style.display = 'block';
            } else {
                backToTop.style.display = 'none';
            }
        });

        // セクションへのスムーススクロール
        document.querySelectorAll('a[href^="#"]').forEach(anchor => {
            anchor.addEventListener('click', function (e) {
                e.preventDefault();
                const target = document.querySelector(this.getAttribute('href'));
                if (target) {
                    target.scrollIntoView({
                        behavior: 'smooth'
                    });
                }
            });
        });

        // 印刷機能のキーボードショートカット
        document.addEventListener('keydown', function(e) {
            if (e.ctrlKey && e.key === 'p') {
                e.preventDefault();
                window.print();
            }
        });
    </script>
</body>
</html>
