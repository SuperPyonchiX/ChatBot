<svg viewBox="0 0 1200 800" xmlns="http://www.w3.org/2000/svg">
  <defs>
    <!-- グラデーション定義 -->
    <linearGradient id="clientGradient" x1="0%" y1="0%" x2="100%" y2="100%">
      <stop offset="0%" style="stop-color:#007bff;stop-opacity:1" />
      <stop offset="100%" style="stop-color:#0056b3;stop-opacity:1" />
    </linearGradient>
    
    <linearGradient id="storageGradient" x1="0%" y1="0%" x2="100%" y2="100%">
      <stop offset="0%" style="stop-color:#28a745;stop-opacity:1" />
      <stop offset="100%" style="stop-color:#1e7e34;stop-opacity:1" />
    </linearGradient>
    
    <linearGradient id="apiGradient" x1="0%" y1="0%" x2="100%" y2="100%">
      <stop offset="0%" style="stop-color:#ffc107;stop-opacity:1" />
      <stop offset="100%" style="stop-color:#e0a800;stop-opacity:1" />
    </linearGradient>
    
    <linearGradient id="azureGradient" x1="0%" y1="0%" x2="100%" y2="100%">
      <stop offset="0%" style="stop-color:#6f42c1;stop-opacity:1" />
      <stop offset="100%" style="stop-color:#5a2d91;stop-opacity:1" />
    </linearGradient>

    <!-- ドロップシャドウフィルター -->
    <filter id="shadow" x="-50%" y="-50%" width="200%" height="200%">
      <feDropShadow dx="3" dy="3" stdDeviation="2" flood-opacity="0.3"/>
    </filter>

    <!-- 矢印マーカー -->
    <marker id="arrowhead" markerWidth="10" markerHeight="7" 
            refX="9" refY="3.5" orient="auto">
      <polygon points="0 0, 10 3.5, 0 7" fill="#333" />
    </marker>
  </defs>

  <!-- 背景 -->
  <rect width="1200" height="800" fill="#f8f9fa" stroke="none"/>

  <!-- タイトル -->
  <text x="600" y="40" text-anchor="middle" font-family="Arial, sans-serif" 
        font-size="28" font-weight="bold" fill="#333">
    ChatBot システム構成図
  </text>

  <!-- ユーザーインターフェース層 -->
  <rect x="50" y="80" width="1100" height="200" rx="15" ry="15" 
        fill="#e1d5e7" stroke="#9673a6" stroke-width="2" filter="url(#shadow)"/>
  <text x="70" y="110" font-family="Arial, sans-serif" font-size="18" 
        font-weight="bold" fill="#333">ユーザーインターフェース層</text>

  <!-- HTML/CSS/JS コンポーネント -->
  <rect x="80" y="130" width="120" height="80" rx="8" ry="8" 
        fill="url(#clientGradient)" stroke="#0056b3" stroke-width="2"/>
  <text x="140" y="155" text-anchor="middle" font-family="Arial, sans-serif" 
        font-size="12" font-weight="bold" fill="white">index.html</text>
  <text x="140" y="175" text-anchor="middle" font-family="Arial, sans-serif" 
        font-size="11" fill="white">メインアプリ</text>
  <text x="140" y="190" text-anchor="middle" font-family="Arial, sans-serif" 
        font-size="11" fill="white">HTML/CSS/JS</text>

  <!-- CSS コンポーネント -->
  <rect x="220" y="130" width="100" height="35" rx="5" ry="5" 
        fill="#f8cecc" stroke="#b85450" stroke-width="1"/>
  <text x="270" y="152" text-anchor="middle" font-family="Arial, sans-serif" 
        font-size="11" font-weight="bold" fill="#333">CSS Base</text>

  <rect x="220" y="175" width="100" height="35" rx="5" ry="5" 
        fill="#f8cecc" stroke="#b85450" stroke-width="1"/>
  <text x="270" y="197" text-anchor="middle" font-family="Arial, sans-serif" 
        font-size="11" font-weight="bold" fill="#333">Components</text>

  <!-- JavaScript モジュール -->
  <rect x="340" y="130" width="280" height="80" rx="8" ry="8" 
        fill="#dae8fc" stroke="#6c8ebf" stroke-width="2"/>
  <text x="480" y="155" text-anchor="middle" font-family="Arial, sans-serif" 
        font-size="14" font-weight="bold" fill="#333">JavaScript モジュール</text>
  
  <rect x="350" y="165" width="60" height="20" rx="3" ry="3" 
        fill="white" stroke="#6c8ebf" stroke-width="1"/>
  <text x="380" y="177" text-anchor="middle" font-family="Arial, sans-serif" 
        font-size="9" fill="#333">Core</text>

  <rect x="420" y="165" width="60" height="20" rx="3" ry="3" 
        fill="white" stroke="#6c8ebf" stroke-width="1"/>
  <text x="450" y="177" text-anchor="middle" font-family="Arial, sans-serif" 
        font-size="9" fill="#333">Components</text>

  <rect x="490" y="165" width="60" height="20" rx="3" ry="3" 
        fill="white" stroke="#6c8ebf" stroke-width="1"/>
  <text x="520" y="177" text-anchor="middle" font-family="Arial, sans-serif" 
        font-size="9" fill="#333">Utils</text>

  <rect x="560" y="165" width="50" height="20" rx="3" ry="3" 
        fill="white" stroke="#6c8ebf" stroke-width="1"/>
  <text x="585" y="177" text-anchor="middle" font-family="Arial, sans-serif" 
        font-size="9" fill="#333">Modals</text>

  <!-- 外部ライブラリ -->
  <rect x="650" y="130" width="200" height="80" rx="8" ry="8" 
        fill="#d5e8d4" stroke="#82b366" stroke-width="2"/>
  <text x="750" y="155" text-anchor="middle" font-family="Arial, sans-serif" 
        font-size="14" font-weight="bold" fill="#333">外部ライブラリ</text>
  
  <rect x="660" y="165" width="50" height="20" rx="3" ry="3" 
        fill="white" stroke="#82b366" stroke-width="1"/>
  <text x="685" y="177" text-anchor="middle" font-family="Arial, sans-serif" 
        font-size="9" fill="#333">Prism.js</text>

  <rect x="720" y="165" width="50" height="20" rx="3" ry="3" 
        fill="white" stroke="#82b366" stroke-width="1"/>
  <text x="745" y="177" text-anchor="middle" font-family="Arial, sans-serif" 
        font-size="9" fill="#333">Marked.js</text>

  <rect x="780" y="165" width="50" height="20" rx="3" ry="3" 
        fill="white" stroke="#82b366" stroke-width="1"/>
  <text x="805" y="177" text-anchor="middle" font-family="Arial, sans-serif" 
        font-size="9" fill="#333">JSCPP</text>

  <!-- 実行環境 -->
  <rect x="870" y="130" width="260" height="80" rx="8" ry="8" 
        fill="#fff3cd" stroke="#ffc107" stroke-width="2"/>
  <text x="1000" y="155" text-anchor="middle" font-family="Arial, sans-serif" 
        font-size="14" font-weight="bold" fill="#333">コード実行環境</text>
  
  <rect x="880" y="165" width="50" height="20" rx="3" ry="3" 
        fill="white" stroke="#ffc107" stroke-width="1"/>
  <text x="905" y="177" text-anchor="middle" font-family="Arial, sans-serif" 
        font-size="9" fill="#333">JavaScript</text>

  <rect x="940" y="165" width="50" height="20" rx="3" ry="3" 
        fill="white" stroke="#ffc107" stroke-width="1"/>
  <text x="965" y="177" text-anchor="middle" font-family="Arial, sans-serif" 
        font-size="9" fill="#333">Python</text>

  <rect x="1000" y="165" width="40" height="20" rx="3" ry="3" 
        fill="white" stroke="#ffc107" stroke-width="1"/>
  <text x="1020" y="177" text-anchor="middle" font-family="Arial, sans-serif" 
        font-size="9" fill="#333">C++</text>

  <rect x="1050" y="165" width="70" height="20" rx="3" ry="3" 
        fill="white" stroke="#ffc107" stroke-width="1"/>
  <text x="1085" y="177" text-anchor="middle" font-family="Arial, sans-serif" 
        font-size="9" fill="#333">HTML/CSS</text>

  <!-- データ層 -->
  <text x="70" y="340" font-family="Arial, sans-serif" font-size="18" 
        font-weight="bold" fill="#333">データ層</text>

  <!-- ローカルストレージ -->
  <rect x="200" y="380" width="300" height="120" rx="10" ry="10" 
        fill="url(#storageGradient)" stroke="#1e7e34" stroke-width="2" filter="url(#shadow)"/>
  <text x="350" y="410" text-anchor="middle" font-family="Arial, sans-serif" 
        font-size="16" font-weight="bold" fill="white">ローカルストレージ</text>
  
  <rect x="220" y="430" width="80" height="25" rx="3" ry="3" 
        fill="white" stroke="#1e7e34" stroke-width="1"/>
  <text x="260" y="447" text-anchor="middle" font-family="Arial, sans-serif" 
        font-size="10" fill="#333">チャット履歴</text>

  <rect x="310" y="430" width="80" height="25" rx="3" ry="3" 
        fill="white" stroke="#1e7e34" stroke-width="1"/>
  <text x="350" y="447" text-anchor="middle" font-family="Arial, sans-serif" 
        font-size="10" fill="#333">API設定</text>

  <rect x="400" y="430" width="80" height="25" rx="3" ry="3" 
        fill="white" stroke="#1e7e34" stroke-width="1"/>
  <text x="440" y="447" text-anchor="middle" font-family="Arial, sans-serif" 
        font-size="10" fill="#333">プロンプト</text>

  <rect x="220" y="465" width="80" height="25" rx="3" ry="3" 
        fill="white" stroke="#1e7e34" stroke-width="1"/>
  <text x="260" y="482" text-anchor="middle" font-family="Arial, sans-serif" 
        font-size="10" fill="#333">添付ファイル</text>

  <rect x="310" y="465" width="80" height="25" rx="3" ry="3" 
        fill="white" stroke="#1e7e34" stroke-width="1"/>
  <text x="350" y="482" text-anchor="middle" font-family="Arial, sans-serif" 
        font-size="10" fill="#333">暗号化キー</text>

  <rect x="400" y="465" width="80" height="25" rx="3" ry="3" 
        fill="white" stroke="#1e7e34" stroke-width="1"/>
  <text x="440" y="482" text-anchor="middle" font-family="Arial, sans-serif" 
        font-size="10" fill="#333">UI設定</text>

  <!-- API層 -->
  <text x="70" y="560" font-family="Arial, sans-serif" font-size="18" 
        font-weight="bold" fill="#333">API層</text>

  <!-- OpenAI API -->
  <rect x="200" y="600" width="200" height="120" rx="10" ry="10" 
        fill="url(#apiGradient)" stroke="#e0a800" stroke-width="2" filter="url(#shadow)"/>
  <text x="300" y="630" text-anchor="middle" font-family="Arial, sans-serif" 
        font-size="16" font-weight="bold" fill="white">OpenAI API</text>
  
  <rect x="220" y="650" width="70" height="20" rx="3" ry="3" 
        fill="white" stroke="#e0a800" stroke-width="1"/>
  <text x="255" y="662" text-anchor="middle" font-family="Arial, sans-serif" 
        font-size="9" fill="#333">gpt-4o</text>

  <rect x="300" y="650" width="80" height="20" rx="3" ry="3" 
        fill="white" stroke="#e0a800" stroke-width="1"/>
  <text x="340" y="662" text-anchor="middle" font-family="Arial, sans-serif" 
        font-size="9" fill="#333">gpt-4o-mini</text>

  <rect x="220" y="680" width="60" height="20" rx="3" ry="3" 
        fill="white" stroke="#e0a800" stroke-width="1"/>
  <text x="250" y="692" text-anchor="middle" font-family="Arial, sans-serif" 
        font-size="9" fill="#333">o1</text>

  <rect x="290" y="680" width="90" height="20" rx="3" ry="3" 
        fill="white" stroke="#e0a800" stroke-width="1"/>
  <text x="335" y="692" text-anchor="middle" font-family="Arial, sans-serif" 
        font-size="9" fill="#333">o1-mini</text>

  <!-- Azure OpenAI API -->
  <rect x="450" y="600" width="200" height="120" rx="10" ry="10" 
        fill="url(#azureGradient)" stroke="#5a2d91" stroke-width="2" filter="url(#shadow)"/>
  <text x="550" y="630" text-anchor="middle" font-family="Arial, sans-serif" 
        font-size="16" font-weight="bold" fill="white">Azure OpenAI API</text>
  
  <rect x="470" y="650" width="70" height="20" rx="3" ry="3" 
        fill="white" stroke="#5a2d91" stroke-width="1"/>
  <text x="505" y="662" text-anchor="middle" font-family="Arial, sans-serif" 
        font-size="9" fill="#333">企業向け</text>

  <rect x="550" y="650" width="80" height="20" rx="3" ry="3" 
        fill="white" stroke="#5a2d91" stroke-width="1"/>
  <text x="590" y="662" text-anchor="middle" font-family="Arial, sans-serif" 
        font-size="9" fill="#333">セキュア</text>

  <rect x="470" y="680" width="60" height="20" rx="3" ry="3" 
        fill="white" stroke="#5a2d91" stroke-width="1"/>
  <text x="500" y="692" text-anchor="middle" font-family="Arial, sans-serif" 
        font-size="9" fill="#333">RBAC</text>

  <rect x="540" y="680" width="90" height="20" rx="3" ry="3" 
        fill="white" stroke="#5a2d91" stroke-width="1"/>
  <text x="585" y="692" text-anchor="middle" font-family="Arial, sans-serif" 
        font-size="9" fill="#333">コンプライアンス</text>

  <!-- セキュリティ要素 -->
  <rect x="750" y="600" width="180" height="120" rx="10" ry="10" 
        fill="#d1ecf1" stroke="#bee5eb" stroke-width="2" filter="url(#shadow)"/>
  <text x="840" y="630" text-anchor="middle" font-family="Arial, sans-serif" 
        font-size="16" font-weight="bold" fill="#0c5460">セキュリティ</text>
  
  <rect x="770" y="650" width="60" height="20" rx="3" ry="3" 
        fill="white" stroke="#bee5eb" stroke-width="1"/>
  <text x="800" y="662" text-anchor="middle" font-family="Arial, sans-serif" 
        font-size="9" fill="#333">HTTPS</text>

  <rect x="840" y="650" width="70" height="20" rx="3" ry="3" 
        fill="white" stroke="#bee5eb" stroke-width="1"/>
  <text x="875" y="662" text-anchor="middle" font-family="Arial, sans-serif" 
        font-size="9" fill="#333">暗号化</text>

  <rect x="770" y="680" width="60" height="20" rx="3" ry="3" 
        fill="white" stroke="#bee5eb" stroke-width="1"/>
  <text x="800" y="692" text-anchor="middle" font-family="Arial, sans-serif" 
        font-size="9" fill="#333">CSP</text>

  <rect x="840" y="680" width="70" height="20" rx="3" ry="3" 
        fill="white" stroke="#bee5eb" stroke-width="1"/>
  <text x="875" y="692" text-anchor="middle" font-family="Arial, sans-serif" 
        font-size="9" fill="#333">SameSite</text>

  <!-- 接続線 -->
  <!-- クライアントからストレージ -->
  <line x1="350" y1="290" x2="350" y2="370" stroke="#333" stroke-width="2" 
        marker-end="url(#arrowhead)"/>
  <text x="360" y="330" font-family="Arial, sans-serif" font-size="11" fill="#333">
    データ保存/読込
  </text>

  <!-- クライアントからOpenAI -->
  <line x1="300" y1="290" x2="300" y2="590" stroke="#333" stroke-width="2" 
        marker-end="url(#arrowhead)"/>
  <text x="210" y="530" font-family="Arial, sans-serif" font-size="11" fill="#333">
    API要求/応答
  </text>

  <!-- クライアントからAzure -->
  <line x1="550" y1="290" x2="550" y2="590" stroke="#333" stroke-width="2" 
        marker-end="url(#arrowhead)"/>
  <text x="560" y="530" font-family="Arial, sans-serif" font-size="11" fill="#333">
    API要求/応答
  </text>

  <!-- セキュリティへの接続 -->
  <line x1="650" y1="650" x2="740" y2="650" stroke="#dc3545" stroke-width="2" 
        stroke-dasharray="5,5"/>
  <text x="680" y="640" font-family="Arial, sans-serif" font-size="10" fill="#dc3545">
    セキュア通信
  </text>

  <!-- 双方向矢印（ストレージ） -->
  <line x1="350" y1="380" x2="350" y2="300" stroke="#333" stroke-width="1" 
        stroke-dasharray="3,3" marker-end="url(#arrowhead)"/>

  <!-- データフロー説明 -->
  <rect x="980" y="400" width="200" height="150" rx="8" ry="8" 
        fill="#f8f9fa" stroke="#dee2e6" stroke-width="1" fill-opacity="0.9"/>
  <text x="1080" y="425" text-anchor="middle" font-family="Arial, sans-serif" 
        font-size="14" font-weight="bold" fill="#333">データフロー</text>
  
  <text x="990" y="445" font-family="Arial, sans-serif" font-size="11" fill="#333">
    1. ユーザー入力
  </text>
  <text x="990" y="460" font-family="Arial, sans-serif" font-size="11" fill="#333">
    2. ローカル検証
  </text>
  <text x="990" y="475" font-family="Arial, sans-serif" font-size="11" fill="#333">
    3. API要求送信
  </text>
  <text x="990" y="490" font-family="Arial, sans-serif" font-size="11" fill="#333">
    4. AI応答受信
  </text>
  <text x="990" y="505" font-family="Arial, sans-serif" font-size="11" fill="#333">
    5. レスポンス処理
  </text>
  <text x="990" y="520" font-family="Arial, sans-serif" font-size="11" fill="#333">
    6. UI更新
  </text>
  <text x="990" y="535" font-family="Arial, sans-serif" font-size="11" fill="#333">
    7. 履歴保存
  </text>

  <!-- 凡例 -->
  <rect x="50" y="730" width="400" height="50" rx="5" ry="5" 
        fill="#fff" stroke="#dee2e6" stroke-width="1"/>
  <text x="60" y="750" font-family="Arial, sans-serif" font-size="12" 
        font-weight="bold" fill="#333">凡例:</text>
  
  <line x1="100" y1="755" x2="120" y2="755" stroke="#333" stroke-width="2" 
        marker-end="url(#arrowhead)"/>
  <text x="125" y="760" font-family="Arial, sans-serif" font-size="10" fill="#333">
    データフロー
  </text>

  <line x1="200" y1="755" x2="220" y2="755" stroke="#dc3545" stroke-width="2" 
        stroke-dasharray="5,5"/>
  <text x="225" y="760" font-family="Arial, sans-serif" font-size="10" fill="#333">
    セキュア通信
  </text>

  <line x1="310" y1="755" x2="330" y2="755" stroke="#333" stroke-width="1" 
        stroke-dasharray="3,3" marker-end="url(#arrowhead)"/>
  <text x="335" y="760" font-family="Arial, sans-serif" font-size="10" fill="#333">
    双方向通信
  </text>
</svg>
